# Проект: Электронная таблица

## Описание проекта

Проект представляет собой реализацию простой электронной таблицы, поддерживающей базовые операции с ячейками, включая хранение текстовых данных, числовых значений и формул. Таблица позволяет вычислять значения ячеек на основе формул, обрабатывать ошибки и предотвращать циклические зависимости.

## Основные компоненты проекта

### 1. **Ячейка (Cell)**
   - **cell.h** и **cell.cpp** содержат реализацию класса `Cell`, который представляет собой ячейку в таблице.
   - Ячейка может содержать:
     - Текстовые данные.
     - Числовые значения.
     - Формулы, которые могут ссылаться на другие ячейки.
   - Поддерживается кэширование значений для оптимизации вычислений.
   - Реализована проверка на циклические зависимости при установке формул.

### 2. **Таблица (Sheet)**
   - **sheet.h** и **sheet.cpp** содержат реализацию класса `Sheet`, который представляет собой таблицу, состоящую из ячеек.
   - Таблица поддерживает:
     - Добавление и удаление ячеек.
     - Очистку ячеек.
     - Получение значений и текста ячеек.
     - Печать таблицы в текстовом и числовом формате.
   - Реализована проверка на допустимость позиций ячеек.

### 3. **Формулы (Formula)**
   - **formula.h** и **formula.cpp** содержат реализацию класса `Formula`, который представляет собой математическую формулу.
   - Формулы поддерживают:
     - Арифметические операции (сложение, вычитание, умножение, деление).
     - Ссылки на другие ячейки.
     - Обработку ошибок (например, деление на ноль).
   - Реализован парсер формул с использованием ANTLR.

### 4. **Общие структуры (Common)**
   - **common.h** и **structures.cpp** содержат вспомогательные структуры и функции, такие как:
     - `Position` — представление позиции ячейки в таблице.
     - `Size` — размер таблицы.
     - `FormulaError` — обработка ошибок в формулах.

### 5. **Тестирование (Tests)**
   - **main.cpp** содержит набор тестов для проверки функциональности таблицы, ячеек и формул.
   - Тесты проверяют:
     - Корректность работы с позициями ячеек.
     - Обработку текстовых и числовых данных.
     - Вычисление формул и обработку ошибок.
     - Проверку на циклические зависимости.

### 6. **Сборка проекта (CMake)**
   - **CMakeLists.txt** содержит конфигурацию для сборки проекта с использованием CMake.
   - Проект использует ANTLR для генерации парсера формул.

## Как использовать проект

1. **Сборка проекта**:
   - Убедитесь, что у вас установлен CMake и ANTLR.
   - Создайте директорию для сборки и выполните команды:
     ```bash
     cmake ..
     make
     ```

2. **Запуск тестов**:
   - После сборки запустите исполняемый файл `spreadsheet` для выполнения тестов:
     ```bash
     ./spreadsheet
     ```

3. **Использование таблицы**:
   - Вы можете использовать классы `Sheet` и `Cell` в своих проектах для работы с электронными таблицами.
   - Пример использования:
     ```cpp
     auto sheet = CreateSheet();
     sheet->SetCell("A1"_pos, "42");
     sheet->SetCell("A2"_pos, "=A1+10");
     std::cout << sheet->GetCell("A2"_pos)->GetValue() << std::endl;  // Выведет 52
     ```

## Зависимости

- **ANTLR**: Используется для парсинга формул.
- **CMake**: Для сборки проекта.
- **C++17**: Проект написан с использованием стандарта C++17.
